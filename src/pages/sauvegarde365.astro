---
import SiteLayout from "../layouts/SiteLayout.astro";
import "../styles/global.css";
import logo from "../assets/eesad-logo.png";
import { theme } from "../config/theme.js";

const { bandBackground, waveFill, glowColor } = theme.colors;
---

<SiteLayout title="Sauvegarde Cloud Microsoft 365 ‚Äì E√âSAD">
  <!-- HEADER SLOT -->
  <div slot="header" class="relative mx-auto flex flex-col items-center gap-3 z-10">
    <img src={logo.src} alt="E√âSAD" class="h-20 w-auto" />
    <h1 class="text-sm tracking-[0.25em] text-slate-400 uppercase">
      Sauvegarde Cloud Microsoft 365
    </h1>
  </div>

  <!-- HERO SLOT -->
  <section slot="hero" class="mx-auto max-w-5xl px-4 text-center relative z-10">
    <!-- Glow -->
    <div
      class="absolute left-1/2 top-10 -translate-x-1/2 
             w-[75%] md:w-[60%] h-28
             bg-gradient-to-r from-blue-500/25 via-indigo-500/25 to-purple-500/25
             blur-[75px] opacity-90"
    ></div>

    <h2 class="text-4xl md:text-6xl font-semibold tracking-tight text-slate-100">
      Une vraie sauvegarde pour Microsoft 365.
      <span class="block text-slate-300 font-medium mt-2 text-2xl md:text-3xl">
        R√©cup√©rez vos donn√©es en minutes ‚Äî m√™me apr√®s un incident.
      </span>
    </h2>

    <p class="mt-5 text-lg md:text-xl text-slate-300 leading-relaxed">
      Courriels (Exchange), OneDrive, SharePoint et Teams ‚Äî
      prot√©g√©s par une solution de sauvegarde <span class="text-slate-100 font-semibold">ind√©pendante</span>,
      fiable et h√©berg√©e au Canada.
    </p>

    <!-- Quick value pills -->
    <div class="mt-6 flex flex-wrap justify-center gap-3">
      <div class="px-4 py-2 rounded-xl bg-slate-800/60 border border-slate-700 text-slate-200 text-sm">
        ‚úÖ Restauration granulaire (fichier, dossier, courriel)
      </div>
      <div class="px-4 py-2 rounded-xl bg-slate-800/60 border border-slate-700 text-slate-200 text-sm">
        ‚úÖ Protection contre ransomware & erreurs humaines
      </div>
      <div class="px-4 py-2 rounded-xl bg-slate-800/60 border border-slate-700 text-slate-200 text-sm">
        ‚úÖ Donn√©es h√©berg√©es au Canada
      </div>
    </div>

    <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-3">
      <a
        href="#activer"
        class="inline-block px-7 py-3 rounded-xl font-semibold
               bg-gradient-to-r from-blue-400 to-indigo-400
               text-slate-900 hover:brightness-110 transition"
      >
        Activer la sauvegarde
      </a>
      <a
        href="#pourquoi"
        class="inline-block px-7 py-3 rounded-xl font-semibold
               bg-slate-900/40 border border-slate-700 text-slate-200
               hover:bg-slate-800/50 hover:border-slate-600 transition"
      >
        Voir pourquoi c‚Äôest essentiel
      </a>
    </div>

    <p class="mt-4 text-sm text-slate-400">
      Installation incluse ‚Ä¢ Support E√âSAD ‚Ä¢ Engagement 36 mois
    </p>
  </section>

  <!-- FIXED BACK LINK -->
  <a
    href="/"
    class="fixed right-6 top-5 z-50
           inline-flex items-center px-4 py-2 rounded-lg
           bg-slate-800/80 border border-slate-700 
           text-slate-200 text-sm font-medium
           hover:bg-slate-700 hover:border-sky-400 hover:text-sky-100
           shadow-lg backdrop-blur
           transition-all"
  >
    ‚Üê Retour √† la page Services TI
  </a>

  <!-- WAVE + CONTENT BAND -->
  <section
    class="relative w-full overflow-hidden -mt-20"
    style={`background-color: ${bandBackground};`}
  >
    <!-- Under-wave lighting -->
    <div
      class="absolute top-40 left-0 right-0 mx-auto w-[90%] h-44 
             bg-blue-500/10 blur-3xl z-0"
    ></div>

    <!-- Gradient overlay -->
    <div
      class="absolute inset-0 bg-gradient-to-b 
             from-transparent to-slate-950/45
             z-[1]"
    ></div>

    <!-- WAVE -->
    <svg
      viewBox="0 0 1440 320"
      preserveAspectRatio="none"
      class="pointer-events-none absolute top-0 left-0 w-full h-96 z-[2]"
      style={`color: ${waveFill};`}
    >
      <path
        fill="currentColor"
        d="
          M0,220
          C240,140 480,300 720,220
          C960,140 1200,300 1440,220
          L1440,0 L0,0 Z
        "
      />
    </svg>

    <!-- Extra glow behind content -->
    <div
      class="absolute top-40 left-0 right-0 mx-auto w-[90%] h-44 blur-3xl z-0"
      style={`background-color: ${glowColor};`}
    ></div>

    <!-- CONTENT -->
    <div class="relative z-[3] mx-auto max-w-6xl px-4 pb-20 space-y-12 mt-24">
      <!-- SECTION TITLE -->
      <div id="pourquoi" class="text-center">
        <h3 class="text-slate-400 text-xs uppercase tracking-[0.25em]">
          Pourquoi une sauvegarde ind√©pendante?
        </h3>
        <p class="mt-4 text-2xl md:text-3xl font-semibold text-slate-100">
          Parce que Microsoft 365 n‚Äôest pas une strat√©gie de restauration.
        </p>
        <!--<p class="mt-3 text-slate-300 max-w-3xl mx-auto leading-relaxed">
          Microsoft offre des outils de r√©tention et de r√©cup√©ration, mais ils ont des limites.
          Une vraie sauvegarde vous donne une copie ind√©pendante et une restauration rapide,
          m√™me apr√®s une erreur, une suppression, une corruption ou une attaque.
        </p>-->
      </div>

      <!-- WHY GRID -->
      <section class="grid md:grid-cols-2 gap-10">
        <!-- Left: marketing + risks -->
        <div class="space-y-6">
          <div
            class="p-6 rounded-2xl bg-gradient-to-br from-slate-800/70 to-slate-900/70
                   border border-slate-700 shadow-lg"
          >
            <p class="text-slate-100 text-xl leading-relaxed font-semibold">
              Microsoft 365 prot√®ge vos services‚Ä¶
              <span class="text-blue-300">mais ce n‚Äôest pas une sauvegarde.</span>
            </p>
            <p class="mt-3 text-slate-300 text-base leading-relaxed">
              Quand √ßa arrive, vous voulez une seule chose : <span class="text-slate-100 font-semibold">r√©cup√©rer vite</span>,
              sans stress, sans perte, sans d√©pendre d‚Äôune ‚Äúchance‚Äù de r√©cup√©ration.
            </p>
            <div
              class="mt-4 inline-flex items-center gap-2 px-3 py-2 rounded-xl
                     bg-slate-800/70 border border-slate-700 text-slate-200 text-sm"
            >
              <span class="text-blue-400">‚úÖ</span>
              Restauration granulaire, rapide et ind√©pendante
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div class="flex gap-3 p-4 rounded-xl bg-slate-800/50 border border-slate-700">
              <span class="text-blue-400 text-xl">üóëÔ∏è</span>
              <div>
                <p class="text-slate-100 font-semibold">Suppression accidentelle</p>
                <p class="text-slate-300 text-sm">Fichiers, courriels, dossiers supprim√©s trop vite.</p>
              </div>
            </div>

            <div class="flex gap-3 p-4 rounded-xl bg-slate-800/50 border border-slate-700">
              <span class="text-red-400 text-xl">ü¶†</span>
              <div>
                <p class="text-slate-100 font-semibold">Ransomware & compromission</p>
                <p class="text-slate-300 text-sm">OneDrive / SharePoint / Exchange sont des cibles.</p>
              </div>
            </div>

            <div class="flex gap-3 p-4 rounded-xl bg-slate-800/50 border border-slate-700">
              <span class="text-purple-400 text-xl">üìÑ</span>
              <div>
                <p class="text-slate-100 font-semibold">Fichiers corrompus</p>
                <p class="text-slate-300 text-sm">Alt√©ration silencieuse, sync, mauvaises versions.</p>
              </div>
            </div>

            <div class="flex gap-3 p-4 rounded-xl bg-slate-800/50 border border-slate-700">
              <span class="text-indigo-400 text-xl">‚è±Ô∏è</span>
              <div>
                <p class="text-slate-100 font-semibold">R√©cup√©ration limit√©e</p>
                <p class="text-slate-300 text-sm">R√©tention, d√©lais, politiques: pas illimit√©.</p>
              </div>
            </div>

            <div class="flex gap-3 p-4 rounded-xl bg-slate-800/50 border border-slate-700 sm:col-span-2">
              <span class="text-yellow-400 text-xl">üë§</span>
              <div>
                <p class="text-slate-100 font-semibold">D√©part d‚Äôemploy√©s</p>
                <p class="text-slate-300 text-sm">Comptes supprim√©s = courriels & fichiers perdus.</p>
              </div>
            </div>
          </div>

          <a
            href="#activer"
            class="inline-flex items-center gap-2 text-sm font-semibold
                   text-blue-300 hover:text-blue-200 transition"
          >
            Voir la tarification et activer la sauvegarde ‚Üí
          </a>
        </div>

        <!-- Right: proof / benefits cards -->
        <div class="grid grid-cols-1 gap-6">
          <div
            class="p-6 rounded-2xl bg-slate-800/40 backdrop-blur border border-slate-700"
          >
            <p class="text-slate-100 text-lg font-semibold">Ce que vous gagnez</p>
            <p class="mt-2 text-slate-300 leading-relaxed">
              Une assurance op√©rationnelle : retrouver rapidement ce qui compte, sans pertes ni interruptions prolong√©es.
            </p>

            <div class="mt-4 space-y-3">
              <div class="flex items-start gap-3">
                <span class="text-blue-400 text-lg">‚ö°</span>
                <p class="text-slate-200">
                  <span class="font-semibold">Restauration en minutes</span> (courriel, fichier, dossier, biblioth√®que)
                </p>
              </div>
              <div class="flex items-start gap-3">
                <span class="text-indigo-400 text-lg">üß©</span>
                <p class="text-slate-200">
                  <span class="font-semibold">Granulaire</span> : pas besoin de tout restaurer pour r√©cup√©rer un √©l√©ment
                </p>
              </div>
              <div class="flex items-start gap-3">
                <span class="text-purple-400 text-lg">üõ°Ô∏è</span>
                <p class="text-slate-200">
                  <span class="font-semibold">Ind√©pendante</span> : votre copie reste accessible m√™me apr√®s incident
                </p>
              </div>
            </div>
          </div>

          <div
            class="flex items-start gap-4 p-6 rounded-2xl
                   bg-slate-800/40 backdrop-blur border border-slate-700"
          >
            <!-- Shield Check -->
            <svg
              class="w-10 h-10 text-blue-400"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 6.75l7.5 3.75-7.5 3.75L4.5 10.5l7.5-3.75z"
              />
            </svg>
            <div>
              <p class="text-slate-100 text-lg font-semibold">Protection contre les incidents modernes</p>
              <p class="text-slate-300 mt-1 leading-relaxed">
                La sauvegarde est votre plan de reprise : simple, rapide, et con√ßu pour r√©cup√©rer m√™me quand tout va mal.
              </p>
            </div>
          </div>

          <div
            class="flex items-start gap-4 p-6 rounded-2xl
                   bg-slate-800/40 backdrop-blur border border-slate-700"
          >
            <!-- Document-text -->
            <svg
              class="w-10 h-10 text-indigo-400"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 12h6M9 9h6m-6 6h6m5 2.25V6.75A2.25 2.25 0 0017.25 4.5H6.75A2.25 2.25 0 004.5 6.75v10.5A2.25 2.25 0 006.75 19.5h10.5A2.25 2.25 0 0019.5 17.25z"
              />
            </svg>
            <div>
              <p class="text-slate-100 text-lg font-semibold">Restauration ‚Äúsans casse-t√™te‚Äù</p>
              <p class="text-slate-300 mt-1 leading-relaxed">
                Retrouver un mail, un document ou une version pr√©cise ‚Äî rapidement ‚Äî sans perturber le reste.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- HOW IT WORKS -->
      <section class="rounded-2xl bg-slate-800/35 p-8 border border-slate-700">
        <h4 class="text-2xl font-semibold text-slate-100 mb-6">
          Comment √ßa fonctionne
        </h4>

        <div class="grid md:grid-cols-3 gap-6">
          <div class="rounded-2xl p-6 bg-slate-900/30 border border-slate-700">
            <p class="text-slate-100 font-semibold text-lg">1) Connexion</p>
            <p class="text-slate-300 mt-2 text-sm leading-relaxed">
              On connecte la solution √† votre tenant Microsoft 365 (acc√®s s√©curis√©, configuration guid√©e).
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-900/30 border border-slate-700">
            <p class="text-slate-100 font-semibold text-lg">2) Sauvegardes automatiques</p>
            <p class="text-slate-300 mt-2 text-sm leading-relaxed">
              Des sauvegardes r√©guli√®res prot√®gent Exchange, OneDrive, SharePoint et Teams.
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-900/30 border border-slate-700">
            <p class="text-slate-100 font-semibold text-lg">3) Restauration √† la demande</p>
            <p class="text-slate-300 mt-2 text-sm leading-relaxed">
              Besoin de r√©cup√©rer? On restaure rapidement (fichier, mail, dossier, etc.).
            </p>
          </div>
        </div>
      </section>

      <!-- LOI 25 -->
      <section class="rounded-2xl bg-slate-800/50 p-8 border border-slate-700">
        <div class="flex items-start gap-4">
          <svg
            class="w-12 h-12 text-blue-400 flex-shrink-0"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 6.75l7.5 3.75-7.5 3.75L4.5 10.5l7.5-3.75z"
            />
          </svg>

          <div>
            <h4 class="text-xl font-semibold mb-2 text-blue-300">
              Conformit√© & continuit√© (Loi 25)
            </h4>
            <p class="leading-relaxed text-slate-300">
              La Loi 25 renforce les obligations de protection des renseignements personnels.
              Une sauvegarde ind√©pendante aide √† assurer la continuit√© et la restauration
              apr√®s un incident, tout en r√©duisant l‚Äôimpact op√©rationnel.
            </p>
          </div>
        </div>
      </section>

      <!-- FEATURES GRID -->
      <section>
        <h4 class="text-2xl font-semibold text-slate-100 mb-6">
          Ce qui est inclus
        </h4>

        <div class="grid md:grid-cols-3 gap-6">
          <div class="rounded-2xl p-6 bg-slate-800/40 backdrop-blur border border-slate-700">
            <svg
              class="w-12 h-12 text-blue-400 mb-3"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 16.5v-9m0 9l3-3m-3 3l-3-3m11.25-3a4.5 4.5 0 00-4.5-4.5h-1.28a6 6 0 10-5.47 9"
              />
            </svg>
            <h5 class="font-semibold text-lg mb-2 text-blue-300">
              Sauvegarde automatique
            </h5>
            <p class="text-slate-300 text-sm">
              Exchange, OneDrive, SharePoint et Teams prot√©g√©s sans intervention.
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-800/40 backdrop-blur border border-slate-700">
            <svg
              class="w-12 h-12 text-indigo-400 mb-3"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16.5 9.75l-4.5 4.5-4.5-4.5"
              />
            </svg>
            <h5 class="font-semibold text-lg mb-2 text-indigo-300">
              Restauration rapide
            </h5>
            <p class="text-slate-300 text-sm">
              R√©cup√©ration granulaire : fichier, courriel, dossier ou biblioth√®que.
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-800/40 backdrop-blur border border-slate-700">
            <svg
              class="w-12 h-12 text-purple-400 mb-3"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M3.75 7.5h16.5M3.75 12h16.5M3.75 16.5h16.5"
              />
            </svg>
            <h5 class="font-semibold text-lg mb-2 text-purple-300">
              H√©bergement au Canada
            </h5>
            <p class="text-slate-300 text-sm">
              Une approche align√©e avec les besoins de confidentialit√© et de conformit√©.
            </p>
          </div>
        </div>
      </section>

      <!-- WHY DATTO -->
      <section class="rounded-2xl p-8 bg-slate-800/35 border border-slate-700">
        <h4 class="text-2xl font-semibold text-slate-100 mb-3">
          Pourquoi Datto
        </h4>
        <p class="leading-relaxed text-slate-300">
          Datto est une plateforme reconnue pour la robustesse de ses sauvegardes
          et la qualit√© de ses restaurations. Avec les services TI des E√âSAD, vous obtenez une implantation
          guid√©e, un accompagnement humain, et une solution simple √† op√©rer au quotidien.
        </p>

        <div class="mt-6 grid md:grid-cols-2 gap-4">
          <div class="p-5 rounded-2xl bg-slate-900/25 border border-slate-700">
            <p class="text-slate-100 font-semibold">‚úÖ Implantation incluse</p>
            <p class="text-slate-300 text-sm mt-1">Configuration initiale et validation de la sauvegarde.</p>
          </div>
          <div class="p-5 rounded-2xl bg-slate-900/25 border border-slate-700">
            <p class="text-slate-100 font-semibold">‚úÖ Support & accompagnement</p>
            <p class="text-slate-300 text-sm mt-1">Vous n‚Äô√™tes pas seul lors d‚Äôun incident.</p>
          </div>
        </div>
      </section>

      <!-- FAQ -->
      <section class="space-y-4">
        <h4 class="text-2xl font-semibold text-slate-100">
          Questions fr√©quentes
        </h4>

        <div class="grid md:grid-cols-2 gap-6">
          <div class="rounded-2xl p-6 bg-slate-800/40 border border-slate-700">
            <p class="text-slate-100 font-semibold">‚ÄúOn a d√©j√† OneDrive / SharePoint, c‚Äôest s√©curis√© non?‚Äù</p>
            <p class="text-slate-300 text-sm mt-2 leading-relaxed">
              S√©curis√© ‚â† sauvegard√©. La sync propage aussi les erreurs (suppression, corruption).
              La sauvegarde ind√©pendante sert √† revenir en arri√®re rapidement.
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-800/40 border border-slate-700">
            <p class="text-slate-100 font-semibold">‚ÄúEst-ce que √ßa prot√®ge Teams?‚Äù</p>
            <p class="text-slate-300 text-sm mt-2 leading-relaxed">
              Oui : les donn√©es sous-jacentes (SharePoint/OneDrive/Exchange) qui alimentent Teams
              sont incluses dans la protection.
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-800/40 border border-slate-700">
            <p class="text-slate-100 font-semibold">‚ÄúCombien de temps pour restaurer?‚Äù</p>
            <p class="text-slate-300 text-sm mt-2 leading-relaxed">
              √áa d√©pend du volume, mais l‚Äôobjectif est la restauration rapide et granulaire
              (souvent minutes plut√¥t qu‚Äôheures/jours).
            </p>
          </div>

          <div class="rounded-2xl p-6 bg-slate-800/40 border border-slate-700">
            <p class="text-slate-100 font-semibold">‚ÄúPourquoi h√©bergement au Canada?‚Äù</p>
            <p class="text-slate-300 text-sm mt-2 leading-relaxed">
              Pour mieux r√©pondre aux attentes de confidentialit√© et aux r√©alit√©s de conformit√©
              (notamment au Qu√©bec).
            </p>
          </div>
        </div>
      </section>

      <!-- PRICING / CTA -->
      <section id="activer">
        <div
          class="rounded-2xl p-10 bg-gradient-to-br from-blue-600 to-indigo-600
                 text-white shadow-xl border border-blue-500 relative"
        >
          <h4 class="text-3xl font-semibold mb-2">Tarification simple</h4>
          <p class="text-white/90 text-lg mb-6">
            Activez une sauvegarde ind√©pendante pour Microsoft 365, sans complexit√©.
          </p>

          <p class="text-xl mb-6">
            <span class="font-extrabold text-5xl">$3</span>
            <span class="text-white/90"> / utilisateur / mois</span>
          </p>

          <ul class="list-disc ml-6 space-y-2 text-lg mb-8">
            <li>Configuration initiale incluse</li>
            <li>Engagement 36 mois</li>
            <li>Maintenance mensuelle incluse</li>
            <li>Protection Exchange, OneDrive, SharePoint et Teams</li>
          </ul>

          <div class="flex flex-col sm:flex-row gap-3">
            <button
              id="openFormBtn"
              class="inline-flex justify-center items-center mt-2 px-8 py-3 rounded-xl font-semibold
                     bg-white text-blue-700 hover:bg-slate-100 transition"
            >
              Activer la sauvegarde
            </button>

            <a
              href="/"
              class="inline-flex justify-center items-center mt-2 px-8 py-3 rounded-xl font-semibold
                     bg-white/10 border border-white/20 text-white
                     hover:bg-white/20 transition"
            >
              Parler √† un conseiller
            </a>
          </div>

          <!-- HIDDEN FORM -->
          <div
            id="activationFormContainer"
            class="overflow-hidden max-h-0 opacity-0 transition-all duration-500 mt-6"
          >
            <form
              id="activationForm"
              class="space-y-4 bg-white/10 backdrop-blur p-6 rounded-xl border border-white/20"
            >
              <h5 class="text-xl font-semibold mb-2">
                Demande d‚Äôactivation
              </h5>

              <label class="block text-sm font-medium">
                Nom de l‚Äôorganisation
              </label>
              <input
                type="text"
                name="activation_org"
                required
                class="w-full rounded-lg px-3 py-2 bg-white/20 border border-white/30
                       placeholder-white/40 text-white focus:ring-2 focus:ring-white"
              />

              <label class="block text-sm font-medium">
                Courriel
              </label>
              <input
                type="email"
                name="activation_email"
                required
                class="w-full rounded-lg px-3 py-2 bg-white/20 border border-white/30
                       placeholder-white/40 text-white focus:ring-2 focus:ring-white"
              />

              <label class="block text-sm font-medium">
                Nombre d‚Äôutilisateurs
              </label>
              <input
                type="number"
                name="activation_users"
                required
                class="w-full rounded-lg px-3 py-2 bg-white/20 border border-white/30
                       placeholder-white/40 text-white focus:ring-2 focus:ring-white"
              />

              <button
                type="submit"
                class="mt-4 w-full px-4 py-2 bg-white text-blue-700 rounded-lg font-semibold
                       hover:bg-slate-100 transition"
              >
                Envoyer la demande
              </button>

              <button
                type="button"
                id="closeFormBtn"
                class="mt-2 w-full px-4 py-2 bg-white/10 text-white rounded-lg font-medium
                       border border-white/20 hover:bg-white/20 transition"
              >
                Fermer
              </button>

              <p id="activationStatus" class="text-sm text-white/80 mt-2"></p>
            </form>
          </div>
        </div>
      </section>
    </div>
  </section>
</SiteLayout>

<script>
  const btn = document.getElementById("openFormBtn");
  const closeBtn = document.getElementById("closeFormBtn");
  const panel = document.getElementById("activationFormContainer");
  const form = document.getElementById("activationForm");
  const status = document.getElementById("activationStatus");

  if (btn && closeBtn && panel && form && status) {
    // OPEN PANEL
    btn.addEventListener("click", () => {
      panel.style.maxHeight = panel.scrollHeight + "px";
      panel.style.opacity = "1";
      panel.scrollIntoView({ behavior: "smooth", block: "start" });
    });

    // CLOSE PANEL
    closeBtn.addEventListener("click", () => {
      panel.style.maxHeight = "0";
      panel.style.opacity = "0";
    });

    // FORM SUBMISSION
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const fd = new FormData(form);
      const data = {};
      for (const [k, v] of fd.entries()) data[k] = v;

      status.textContent = "Envoi‚Ä¶";

      try {
        const res = await fetch("/api/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });

        if (res.ok) {
          status.textContent = "Demande envoy√©e! On vous contacte sous peu.";
          form.reset();
        } else {
          status.textContent = "Erreur d‚Äôenvoi. R√©essayez ou contactez-nous.";
        }
      } catch (err) {
        status.textContent = "Erreur r√©seau. R√©essayez plus tard.";
      }
    });
  }
</script>
