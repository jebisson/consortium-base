---
import SiteLayout from "../layouts/SiteLayout.astro";
import logo from "../assets/consortium.png";
import { theme } from "../config/theme.js";

// Theme colors → CSS vars
const {
  background,
  text,
  accent,
  border,
  bandBackground,
  glowColor,
} = theme.colors;

const cards = [
  {
    title: "Sauvegarde Microsoft 365",
    desc: "Protection complète des courriels, fichiers et Teams.",
    link: "/sauvegarde365",
    icon: `
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
        d="M12 16.5v-9m0 9l-3-3m3 3l3-3m-.75-6.75a4.5 4.5 0
            00-8.456 1.09A3.75 3.75 0 006
            13.5h12a3.75 3.75 0 00.206-7.464A4.501 4.501 0
            0012.75 6.75z" />
    `,
  },
  {
    title: "Gestion TI proactive",
    desc: "Supervision 24/7, protection avancée et support rapide pour assurer la stabilité, la sécurité et réduire les coûts.",
    link: "/rmm-edr-kaseya365",
    icon: `
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
        d="M12 3l7 3.5v5.5c0 4.5-3 8.5-7 9.5-4-1-7-5-7-9.5V6.5L12 3z
           M12 11a2 2 0 110 4 2 2 0 010-4z" />
    `,
  },
  {
    title: "Guide pratique employé",
    desc: "Bonnes pratiques numériques : simple, clair, prêt à diffuser.",
    link: "/guide-employe",
    icon: `
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
        d="M3.75 4.5L12 8.25l8.25-3.75v12.75L12 21.75l-8.25-3.75V4.5z" />
    `,
  },
  {
    title: "Service conseil TI",
    desc: "Vérification de soumissions, consultation et recommandations (sans interventions).",
    link: "/service-conseil",
    icon: `
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
        d="M11.25 3.75a7.5 7.5 0 105.303 12.803l3.697 3.697M8.25 11.25h6" />
    `,
  },
  {
    title: "Formations & intégration",
    desc: "Intégration des nouveaux employés + formations Microsoft 365 & cybersécurité.",
    link: "/formation-integration",
    icon: `
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
        d="M12 3l9 4.5-9 4.5-9-4.5L12 3zm7.5 7.5V15c0 1.657-3.357 3-7.5 3s-7.5-1.343-7.5-3v-4.5" />
    `,
  },
];

const securityCard = {
  title: "Sécurité Microsoft 365",
  desc: "Cybersécurité, bonnes pratiques et posture de sécurité M365.",
  link: "/securite365",
  icon: `
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
      d="M9 12.75L11.25 15 15 9.75m-3-6.042a48.42 48.42 0 00-6 2.558A2.25
         2.25 0 005.25 8.91v4.819a6.75 6.75 0 003.022 5.625l3.095
         2.06a.75.75 0 00.816 0l3.095-2.06a6.75 6.75 0 003.022-5.625V8.91a2.25
         2.25 0 00-1.25-2.132 48.42 48.42 0 00-6-2.558z" />
  `,
};

// Full grid = Sécurité + the rest
const serviceCards = [securityCard, ...cards];
---

<SiteLayout title="Services TI – Consortium">
  <div
    style={`
      --bg: ${background};
      --text: ${text};
      --accent: ${accent};
      --border: ${border};
      --band: ${bandBackground};
      --glow: ${glowColor};
    `}
  >
    <!-- HEADER -->
    <div slot="header" class="flex flex-col items-center">
      <img src={logo.src} alt="Consortium" class="h-32 md:h-36 w-auto" />
      <h1
        class="mt-2 text-sm tracking-[0.35em] uppercase"
        style="color: color-mix(in srgb, var(--text) 60%, transparent);"
      >Services TI
      </h1>
    </div>

<!-- HERO SLOT (minimal premium glow) -->
<div
  slot="hero"
  class="relative mx-auto max-w-5xl text-center z-10 pointer-events-auto py-8"
>

  <!-- soft gold glow -->
  <div
    class="pointer-events-none absolute left-1/2 top-6 -translate-x-1/2 w-[70%] md:w-[55%] h-40 blur-[120px] opacity-60"
    style="
      background:
        radial-gradient(circle,
          color-mix(in srgb, var(--accent) 35%, transparent),
          transparent 70%);
    "
  ></div>

  <!-- subtle secondary glow -->
  <div
    class="pointer-events-none absolute left-1/2 top-20 -translate-x-1/2 w-[90%] h-56 blur-[160px] opacity-40"
    style="
      background:
        radial-gradient(circle,
          color-mix(in srgb, var(--accent) 18%, transparent),
          transparent 75%);
    "
  ></div>
  <p
    class="text-sm uppercase tracking-[0.35em]"
    style="color: color-mix(in srgb, var(--text) 65%, transparent);"
  >
    Sécurité • Modernisation • Support
  </p>

  <h2
    class="mt-3 text-4xl md:text-6xl font-semibold tracking-tight"
    style="color: var(--text);"
  >
    Un écosystème TI stable, sécurisé et simple à gérer
  </h2>

  <p
    class="mt-5 text-base md:text-lg leading-relaxed mx-auto max-w-3xl"
    style="color: color-mix(in srgb, var(--text) 82%, transparent);"
  >
    Découvrez nos services et ressources pour protéger Microsoft 365,
    renforcer la posture de sécurité et structurer une gestion TI proactive.
  </p>

  <!-- Premium CTA row -->
  <div class="mt-8 flex flex-wrap justify-center gap-3">
    <a
      href="#services"
      class="inline-flex items-center rounded-xl px-6 py-3 font-semibold transition"
      style="
        background: var(--accent);
        color: #111;
        box-shadow: 0 12px 30px color-mix(in srgb, var(--accent) 35%, transparent);
      "
    >
      Explorer les services →
    </a>

    <!-- <a
      href="/survey"
      class="inline-flex items-center rounded-xl px-6 py-3 font-semibold transition"
      style="
        background: color-mix(in srgb, white 6%, transparent);
        color: var(--text);
        border: 1px solid color-mix(in srgb, white 12%, transparent);
      "
    >
      Questionnaire TI
    </a>-->
  </div>
</div>


    <main>
      <!-- Divider (no wave) -->
      <section class="relative w-full">
        <div class="h-[3px] w-full" style="background: var(--accent);"></div>
        <div class="h-10 w-full"
             style="background: linear-gradient(to bottom, color-mix(in srgb, var(--accent) 16%, transparent), transparent);"></div>
      </section>

      <!-- SERVICES -->
      <section class="relative w-full" style="background: var(--band);">
        <div class="mx-auto max-w-6xl px-4 py-16">
          <div id="services" class="text-center">
            <h4 class="text-md uppercase tracking-[0.35em]"
                style="color: black;">
              Services offerts et ressources
            </h4>
            <p class="mt-2 text-md md:text-base"
               style="color: black;">
              Choisissez un volet pour en savoir plus — chaque page contient une description claire et une demande de soumission.
            </p>
          </div>

          <div class="mt-10 grid gap-8 md:grid-cols-3 items-stretch">

            <!-- Featured (Miguel) -->
            <a
              href="/formation-integration"
              class="group relative overflow-hidden rounded-2xl md:col-span-3
                     backdrop-blur p-6 pb-[240px] md:p-10 md:pr-[22rem]
                     shadow-[0_10px_40px_rgba(0,0,0,0.35)]
                     transition-all duration-300 hover:-translate-y-1"
              style={`
                border: 1px solid color-mix(in srgb, var(--border) 65%, transparent);
                background: color-mix(in srgb, var(--bg) 82%, black 18%);
              `}
            >
              <div
                class="pointer-events-none absolute -top-24 -right-24 h-72 w-72 rounded-full blur-3xl opacity-60"
                style="background: color-mix(in srgb, var(--accent) 18%, transparent);"
              ></div>

              <div class="relative z-[3] max-w-3xl">
                <p class="text-xs uppercase tracking-[0.35em]"
                   style="color: color-mix(in srgb, var(--text) 65%, transparent);">
                  Formations & intégration
                </p>

                <h3 class="mt-2 text-2xl md:text-3xl font-extrabold" style="color: var(--text);">
                  Formations Microsoft 365 & cybersécurité
                  <span style="color: var(--accent);"> animées par Miguel</span>
                </h3>

                <p class="mt-3 text-sm md:text-base leading-relaxed"
                   style="color: color-mix(in srgb, var(--text) 82%, transparent);">
                  Intégration des nouveaux employés, bonnes pratiques M365, prévention des incidents
                  et accompagnement concret adapté à votre réalité.
                </p>

                <div class="mt-5 flex flex-wrap items-center gap-2">
                  {["Onboarding", "Microsoft 365", "Cybersécurité", "Approche pratique"].map((t) => (
                    <span
                      class="inline-flex items-center rounded-full px-3 py-1 text-xs"
                      style={`
                        background: color-mix(in srgb, white 10%, transparent);
                        border: 1px solid color-mix(in srgb, white 12%, transparent);
                        color: var(--text);
                      `}
                    >
                      {t}
                    </span>
                  ))}
                </div>

                <div class="mt-6">
                  <span
                    class="inline-flex items-center justify-center rounded-xl px-6 py-3 font-semibold transition group-hover:brightness-110"
                    style={`
                      background: linear-gradient(90deg,
                        color-mix(in srgb, var(--accent) 92%, white 8%),
                        color-mix(in srgb, var(--accent) 72%, black 28%)
                      );
                      color: #111;
                    `}
                  >
                    Découvrir les formations →
                  </span>
                </div>
              </div>

              <div class="pointer-events-none absolute bottom-0 right-6 md:right-10 z-[2]">
                <div
                  class="absolute -inset-10 rounded-full blur-3xl opacity-70"
                  style="background: color-mix(in srgb, var(--accent) 16%, transparent);"
                ></div>

                <img
                  src="/images/miguel.png"
                  alt="Miguel – formateur"
                  loading="lazy"
                  class="relative h-[200px] sm:h-[220px] md:h-[320px] w-auto object-contain
                         drop-shadow-[0_25px_40px_rgba(0,0,0,0.45)]
                         [mask-image:linear-gradient(to_top,black_85%,transparent_100%)]"
                />
              </div>
            </a>

            <!-- FULL GRID (this is the missing block) -->
            {serviceCards.map((s) => (
              <a
                href={s.link}
                class="group relative overflow-hidden rounded-2xl h-full
                       backdrop-blur p-6 shadow-[0_10px_30px_rgba(0,0,0,0.25)]
                       transition-all duration-300 hover:-translate-y-1"
                style={`
                  border: 1px solid color-mix(in srgb, var(--border) 65%, transparent);
                  background: color-mix(in srgb, var(--bg) 84%, black 16%);
                `}
              >
                <div
                  class="pointer-events-none absolute inset-0 opacity-0 group-hover:opacity-100 transition"
                  style="background: radial-gradient(circle at 20% 20%, color-mix(in srgb, var(--accent) 18%, transparent), transparent 55%);"
                ></div>

                <div class="relative flex min-h-[180px] flex-col justify-between">
                  <div class="flex items-start gap-3">
                    <div
                      class="mt-1 flex h-11 w-11 items-center justify-center rounded-xl"
                      style="background: color-mix(in srgb, white 6%, transparent); border: 1px solid color-mix(in srgb, white 10%, transparent);"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" style="color: var(--accent);" fill="none" viewBox="0 0 24 24" stroke="currentColor" set:html={s.icon}></svg>
                    </div>

                    <div>
                      <h4 class="text-xl font-semibold" style="color: var(--text);">{s.title}</h4>
                      <p class="mt-2 text-sm" style="color: color-mix(in srgb, var(--text) 78%, transparent);">{s.desc}</p>
                    </div>
                  </div>

                  <span class="mt-4 inline-flex items-center text-sm font-semibold transition" style="color: var(--accent);">
                    Voir la page →
                  </span>
                </div>
              </a>
            ))}

            <!-- Questionnaire banner -->
            <a
              href="/survey"
              class="group relative overflow-hidden rounded-2xl md:col-span-3
                     backdrop-blur px-6 py-4 shadow-[0_10px_30px_rgba(0,0,0,0.20)]
                     transition-all duration-300 hover:-translate-y-1"
              style={`
                border: 1px solid color-mix(in srgb, var(--accent) 55%, transparent);
                background: linear-gradient(90deg,
                  color-mix(in srgb, var(--accent) 30%, black 70%),
                  color-mix(in srgb, var(--bg) 70%, black 30%)
                );
              `}
            >
              <div class="pointer-events-none absolute inset-0 opacity-0 group-hover:opacity-100 transition"
                   style="background: linear-gradient(90deg, color-mix(in srgb, white 10%, transparent), transparent 60%);"></div>

              <div class="relative flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                <div>
                  <p class="text-xs uppercase tracking-[0.35em]" style="color: color-mix(in srgb, var(--text) 70%, transparent);">Ressource</p>
                  <h4 class="mt-1 text-lg font-semibold" style="color: var(--text);">Questionnaire TI</h4>
                  <p class="mt-1 text-sm" style="color: color-mix(in srgb, var(--text) 82%, transparent);">
                    Dressez un portrait rapide de votre environnement pour mieux cibler les recommandations.
                  </p>
                </div>

                <span class="shrink-0 inline-flex items-center text-sm font-semibold" style="color: var(--text);">
                  Remplir le questionnaire →
                </span>
              </div>
            </a>

          </div>
        </div>
      </section>
    </main>
  </div>
</SiteLayout>

